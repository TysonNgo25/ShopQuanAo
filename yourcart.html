<!-- yourcart.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lịch Sử Mua Hàng</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
      }
      .container {
        width: 80%;
        margin: 0 auto;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #333;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      table,
      th,
      td {
        border: 1px solid #ddd;
      }
      th,
      td {
        padding: 10px;
        text-align: center;
      }
      th {
        background-color: #f2f2f2;
      }
      .order-details {
        margin-top: 30px;
      }
      .order-details h3 {
        margin-bottom: 10px;
        color: #333;
      }
      .order-details p {
        margin: 5px 0;
      }
      .back-button {
        display: block;
        margin-top: 20px;
        padding: 10px;
        background-color: #007bff;
        color: white;
        text-align: center;
        text-decoration: none;
        border-radius: 5px;
      }
      .back-button:hover {
        background-color: #0056b3;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Lịch Sử Mua Hàng</h1>

      <!-- Bảng hiển thị sản phẩm trong giỏ hàng -->
      <table id="cart-table">
        <thead>
          <tr>
            <th>Tên Sản Phẩm</th>
            <th>Số Lượng</th>
            <th>Giá Tiền</th>
            <th>Tổng Tiền</th>
          </tr>
        </thead>
        <tbody>
          <!-- Sản phẩm sẽ được thêm vào đây thông qua JavaScript -->
        </tbody>
      </table>

      <!-- Thông tin giao hàng -->
      <div class="order-details">
        <h3>Thông Tin Giao Hàng</h3>
        <p><strong>Người nhận:</strong> <span id="recipient"></span></p>
        <p><strong>Số điện thoại:</strong> <span id="phone"></span></p>
        <p><strong>Địa chỉ:</strong> <span id="address"></span></p>
        <p>
          <strong>Phương thức thanh toán:</strong>
          <span id="payment-method"></span>
        </p>
      </div>

      <a href="index.html" class="back-button">Quay lại trang chủ</a>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];

        // Cập nhật giỏ hàng
        function updateCartUI() {
          const cartTableBody = document.querySelector("#cart-table tbody");
          const cartSubtotal = document.querySelector(
            ".cart__total ul li:nth-last-child(2) span"
          );
          const cartTotal = document.querySelector(
            ".cart__total ul li:last-child span"
          );

          if (cart.length === 0) {
            cartTableBody.innerHTML = `<tr><td colspan="4" class="text-center">Your cart is empty!</td></tr>`;
            if (cartTotal) cartTotal.textContent = "$0.00";
            return;
          }

          // Hiển thị sản phẩm trong giỏ hàng
          cartTableBody.innerHTML = cart
            .map(
              (item, index) => `
          <tr>
            <td class="product__cart__item">
              <div class="product__cart__item__pic">
                <img src="${item.image}" alt="${item.name}" />
              </div>
              <div class="product__cart__item__text">
                <h6>${item.name}</h6>
                <h5>$${item.price.toFixed(2)}</h5>
              </div>
            </td>
            <td class="quantity__item">
              <div class="quantity">
                <button class="qty-btn" data-action="decrease" data-index="${index}">-</button>
                <span>${item.quantity}</span>
                <button class="qty-btn" data-action="increase" data-index="${index}">+</button>
              </div>
            </td>
            <td class="cart__price">$${(item.price * item.quantity).toFixed(
              2
            )}</td>
            <td class="cart__close">
              <button class="remove-btn" data-index="${index}">×</button>
            </td>
          </tr>`
            )
            .join("");

          // Tính tổng tiền
          const totalPrice = cart.reduce(
            (sum, item) => sum + item.price * item.quantity,
            0
          );
          if (cartTotal) cartTotal.textContent = `$${totalPrice.toFixed(2)}`;
          if (cartSubtotal)
            cartSubtotal.textContent = `$${totalPrice.toFixed(2)}`;
        }

        // Hiển thị thông tin giao hàng
        const orderDetails = JSON.parse(localStorage.getItem("orderDetails"));
        if (orderDetails) {
          document.getElementById("recipient").textContent =
            orderDetails.recipient;
          document.getElementById("phone").textContent = orderDetails.phone;
          document.getElementById("address").textContent = orderDetails.address;
          document.getElementById("payment-method").textContent =
            orderDetails.paymentMethod;
        } else {
          alert("Không tìm thấy thông tin đơn hàng.");
        }

        updateCartUI(); // Cập nhật giỏ hàng khi trang được tải
      });
    </script>
  </body>
</html>
